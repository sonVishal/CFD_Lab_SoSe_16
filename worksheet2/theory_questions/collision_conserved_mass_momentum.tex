
% question 5: Show that the collision rule in LBM preserves mass and momentum.

\section{Conservation of mass and momentum in the collision rule}



Collision rule:
\begin{equation}
    f_i^*(\vec{x}, \, t) = f_i(\vec{x}, \, t) - \frac{1}{\tau}(f_i(\vec{x},\, t) - f_i^{eq}(\vec{x}, \, t))
\label{collision}
\end{equation}


Approximation to the equilibrium state which holds when the distribution is close to equilibrium:

\begin{equation}
    f_i^{eq}(\vec{x}, \, t) \approx w_i\rho 
    \left[ 1 + 
    \frac{ \vec{c}_i \cdot \vec{u} }{c_s^2} + 
    \frac{(\vec{c}_i \cdot \vec{u})^2}{c_s^4} -
    \frac{\vec{u}\cdot\vec{u}}{c_s^2}
    \right].
\label{approx}
\end{equation}

Properties on $w_i$ (there are more, but only these are needed here):

\begin{equation}
    \sum_{i=0}^{Q-1} w_i  c_i^\alpha  c_i^\beta = c_s^2\delta_{\alpha\beta};
     \quad  \alpha = x,\, y, \, z; \quad \beta= x,\, y, \, z.
\label{prop1}
\end{equation}

\begin{equation}
    \sum_{i=0}^{Q-1} w_i = 1,
\label{prop2}
\end{equation}

\begin{equation}
    \sum_{i=0}^{Q-1} w_i  c_i^\alpha = 0, \quad  \alpha = x,\, y, \, z,
\label{prop3}
\end{equation}


\subsection{Conservation of mass}

Before the collision step we have the density
\begin{equation}
\rho = \sum_{i=0}^{Q-1} f_i(\vec{x}, \, t) .
\end{equation}

After the collision the density is

\begin{equation}
    \rho^* = \sum_{i=0}^{Q-1} f_i^*(\vec{x}, \, t).
\end{equation}


Lets first look at the sum over the equilibrium distribution:

\begin{equation}
    \sum_{i=0}^{Q-1} f_i^{eq}(\vec{x}, \, t) =  \sum_{i=0}^{Q-1} \left( 
     w_i\rho \left[ 1 + 
    \frac{ \vec{c}_i \cdot \vec{u} }{c_s^2} + 
    \frac{(\vec{c}_i \cdot \vec{u})^2}{2c_s^4} -
    \frac{\vec{u}\cdot\vec{u}}{2c_s^2}
    \right]
    \right).
\label{sum_eq}
\end{equation}

By virtue of eq. \ref{prop1}, \ref{prop2} and \ref{prop3} eq. \ref{sum_eq} becomes after some calculation
\begin{equation}
    \sum_{i=0}^{Q-1} f_i^{eq}(\vec{x}, \, t) =  \rho.
\end{equation}

Hence the after collison density becomes

\begin{equation}
    \rho^* = \rho,
\end{equation}

and we have mass conservation.

\subsection{conservation of momentum}

Momentum before collision:
\begin{equation}
\rho\vec{u} = \sum_{i=0}^{Q-1} f_i(\vec{x}, \, t)\vec{c}_i .
\end{equation}

After the collision the momentum is

\begin{equation}
    \rho^*\vec{u}^* = \sum_{i=0}^{Q-1} f_i^*(\vec{x}, \, t)\vec{c_i}.
\end{equation}


Lets first look at the sum over the equilibrium distribution:

\begin{equation}
    \sum_{i=0}^{Q-1} w_i\vec{c_i}f_i^{eq}(\vec{x}, \, t) =  \sum_{i=0}^{Q-1} \left( 
     \vec{c_i}w_i\rho \left[ 1 + 
    \frac{ \vec{c}_i \cdot \vec{u} }{c_s^2} + 
    \frac{(\vec{c}_i \cdot \vec{u})^2}{2c_s^4} -
    \frac{\vec{u}\cdot\vec{u}}{2c_s^2}
    \right]
    \right).
\label{sum_eq_mom}
\end{equation}

By using eq. \ref{prop3} the first and last term inside the square bracket 
becomes zero. The second term inside the square bracket becomes

\begin{equation}
    \sum_{i=0}^{Q-1} 
    \left( \frac{w_i\vec{c}_i(\vec{c}_i \cdot \vec{u_i})}{2c_s^2}
    \right) = \vec{u}.
\end{equation}

By expanding the third term and using eq. \ref{prop1} we get

\begin{align}
    \sum_{i=0}^{Q-1} 
    \left( w_i\vec{c}_i\frac{(\vec{c}_i \cdot \vec{u_i})^2}{2c_s^4}
    \right) &=
    \sum_{i=0}^{Q-1} 
    \left( w_i\vec{c}_i\frac{\vec{c}_i\cdot\vec{c}_i + 2\vec{c}_i\cdot\vec{u} + \vec{u}\cdot\vec{u}}{2c_s^4}
    \right)\\
    &= \sum_{i=0}^{Q-1} \frac{w_i\vec{c}_i(\vec{c}_i \cdot \vec{c}_i)}{2c_s^4} + \frac{\vec{u}}{c_s^2}.
\end{align}


